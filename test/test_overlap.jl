@time @testset "overlap" begin
    water = Molecule(
        [8, 1, 1],
        [0.00000  0.00000  0.22700;
         0.00000  1.35300 -0.90800;
         0.00000 -1.35300 -0.90800]',
    )
    basis = build_sto3g(water)

    # Tests for pairs of basis functions
    @test overlap(basis[1], basis[end]) ≈ 0.056954 atol=5e-7
    @test overlap(basis[1], basis[1]) == 1.0

    # Test for a complete basis set
    @test overlap(basis) ≈ [1.000000 0.236704 0.000000  0.000000  0.000000  0.056954  0.056954;
                            0.236704 1.000000 0.000000  0.000000  0.000000  0.489792  0.489792;
                            0.000000 0.000000 1.000000  0.000000  0.000000  0.000000  0.000000;
                            0.000000 0.000000 0.000000  1.000000  0.000000  0.307379 -0.307379;
                            0.000000 0.000000 0.000000  0.000000  1.000000 -0.257853 -0.257853;
                            0.056954 0.489792 0.000000  0.307379 -0.257853  1.000000  0.282791;
                            0.056954 0.489792 0.000000 -0.307379 -0.257853  0.282791  1.000000] atol=2e-6

    # Test overlap between primitives
    @test GaussianBasisFunctions._primitive_overlap(
        0.1, [1.0, 2.0, 0.0], 1, 1, 0, 0.2, [2.0, 1.0, 0.0], 0, 1, 0
    ) == 28.55923564396704
end
